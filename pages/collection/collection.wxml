<wxs module="util">
  function formatDate(dateStr) {
    if (!dateStr) return '';
    var date = getDate(dateStr);
    var year = date.getFullYear();
    var month = padZero(date.getMonth() + 1);
    var day = padZero(date.getDate());
    return year + '-' + month + '-' + day;
  }
  
  function padZero(num) {
    return num < 10 ? '0' + num : '' + num;
  }
  
  module.exports = {
    formatDate: formatDate
  };
</wxs>

<view class="container collection-page">
  <!-- é¡µé¢èƒŒæ™¯ -->
  <view class="page-bg"></view>
  
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">æˆ‘çš„æ”¶è—</text>
  </view>
  
  <!-- ç™»å½•æç¤º -->
  <view wx:if="{{!isLoggedIn}}" class="login-tip">
    <view class="tip-icon">ğŸ”</view>
    <view class="tip-text">è¯·ç™»å½•åæŸ¥çœ‹æ”¶è—å†…å®¹</view>
    <button class="login-btn" bindtap="navigateToLogin">å»ç™»å½•</button>
  </view>
  
  <!-- æ”¶è—åˆ—è¡¨ -->
  <view wx:elif="{{bookmarkedArticles.length > 0}}" class="bookmarks-container">
    <view 
      wx:for="{{bookmarkedArticles}}" 
      wx:key="articleId" 
      class="article-card"
      bindtap="navigateToArticle"
      data-id="{{item.articleId}}"
    >
      <view class="article-cover-container">
        <image class="article-cover" src="{{item.coverUrl || '/assets/images/default_cover.jpg'}}" mode="aspectFill" lazy-load="true"></image>
      </view>
      <view class="article-info">
        <view class="article-title">{{item.title}}</view>
        <view class="article-meta">
          <text class="article-date">{{item.addTime ? util.formatDate(item.addTime) : ''}}</text>
        </view>
      </view>
      <view class="article-actions" catchtap="stopPropagation">
        <view class="remove-btn" catchtap="removeBookmark" data-id="{{item.articleId}}" data-title="{{item.title}}">
          <text class="remove-icon">Ã—</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- ç©ºæ”¶è—æç¤º -->
  <view wx:else class="empty-bookmarks">
    <view class="empty-icon">ğŸ“š</view>
    <view class="empty-text">æ‚¨è¿˜æ²¡æœ‰æ”¶è—ä»»ä½•æ–‡ç« </view>
    <view class="empty-subtext">æµè§ˆæ–‡ç« æ—¶ç‚¹å‡»æ”¶è—æŒ‰é’®å³å¯æ·»åŠ </view>
    <button class="explore-btn" bindtap="navigateToExplore">å»æ¢ç´¢</button>
  </view>
  
  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <view class="loading-icon"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>

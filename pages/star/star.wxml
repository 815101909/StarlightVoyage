<!--pages/star/star.wxml-->
<view class="container star-page">
  <!-- 顶部背景星空 -->
  <view class="star-bg"></view>
  
  <view class="page-header">
    <text class="page-title">上下未形，何由考之？</text>
    <text class="page-subtitle">先秦 · 屈原·《天问》</text>
  </view>
  

  
  <!-- 太空地图组件 -->
  <view class="space-map">
    <view class="map-header">
      <text class="map-title">太空地图</text>
      <view class="map-tabs">
        <view class="map-tab {{currentMap === 'universe' ? 'active' : ''}}" bindtap="switchMap" data-map="universe">宇宙</view>
        <view class="map-tab {{currentMap === 'galaxy' ? 'active' : ''}}" bindtap="switchMap" data-map="galaxy">星系</view>
        <view class="map-tab {{currentMap === 'celestial' ? 'active' : ''}}" bindtap="switchMap" data-map="celestial">天体</view>
        <view class="map-tab {{currentMap === 'earth' ? 'active' : ''}}" bindtap="switchMap" data-map="earth">地球</view>
      </view>
    </view>
    
    <view class="map-content">
      <!-- 视频播放区域 -->
      <video wx:if="{{mapVideos[currentMap] && !mapVideos[currentMap].error}}" 
             class="map-video" 
             src="{{mapVideos[currentMap].videoUrl}}" 
             poster="{{mapVideos[currentMap].coverUrl}}"
             title="{{mapVideos[currentMap].title}}"
             object-fit="cover"
             controls="{{true}}"
             autoplay="{{false}}"
             loop="{{false}}"
             muted="{{false}}"
             show-center-play-btn="{{true}}"
             play-btn-position="center"
             show-play-btn="{{true}}"
             show-progress="{{true}}"
             show-fullscreen-btn="{{false}}"
             enable-progress-gesture="{{true}}">
      </video>
      <!-- 无视频或视频错误时的占位背景 -->
      <view wx:else class="map-placeholder">
        <view class="placeholder-mask">
          <text class="placeholder-text">{{mapVideos[currentMap] && mapVideos[currentMap].error ? '视频暂时无法播放' : '太空探索中...'}}</text>
        </view>
      </view>
      
      <!-- 视频信息 -->
      <view wx:if="{{mapVideos[currentMap]}}" class="video-info">
        <view class="video-title">{{mapVideos[currentMap].title}}</view>
        <view wx:if="{{mapVideos[currentMap].description}}" class="video-desc">{{mapVideos[currentMap].description}}</view>
        <view wx:if="{{mapVideos[currentMap].duration}}" class="video-duration">时长: {{mapVideos[currentMap].duration}}秒</view>
      </view>
    </view>
  </view>
  
  <!-- 轮播形式展示四个部分 -->
  <view class="swiper-container">
    <swiper class="section-swiper" 
            autoplay="{{autoplay}}" 
            interval="{{interval}}" 
            duration="{{duration}}"
            circular="{{circular}}"
            current="{{current}}"
            bindchange="swiperChange">
            
      <!-- 动态生成星宿卡片 -->
      <swiper-item wx:for="{{sections}}" wx:key="id">
        <view class="section-card" bindtap="navigateToDetail" data-section="{{item.id}}">
          <image class="section-image" src="{{item.coverUrl}}" mode="aspectFill"></image>
          <view class="section-overlay">
            <view class="section-content">
              <view class="section-title">{{item.title}}</view>
              <view class="section-desc">{{item.description}}</view>
            </view>
            <view class="section-icon">→</view>
          </view>
        </view>
      </swiper-item>
    </swiper>
    
    <!-- 轮播指示点 -->
    <view class="swiper-dots">
      <block wx:for="{{sections}}" wx:key="id">
        <view class="dot {{current === index ? 'active' : ''}}" 
              bindtap="dotTap" 
              data-index="{{index}}"></view>
      </block>
    </view>
  </view>
  
  <!-- 底部装饰 -->
  <view class="footer-decoration">
    <view class="footer-text">向宇宙深处探索</view>
  </view>
</view>
